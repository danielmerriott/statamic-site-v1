#
# Apache vhost config file for openleaf.co.nz
#

#live
<VirtualHost *:80>
        ServerName openleaf.co.nz
        ServerAlias ddd.openleaf.co.nz
	ServerAdmin webmaster@openleaf.net.nz

	LogLevel warn
        ErrorLog /data/logs/apache/111-live-error.log
        CustomLog /data/logs/apache/111-live-access.log combined

        DocumentRoot /data/www/openleaf-co-nz/htdocs/tagged

        <IfModule mod_proxy_fcgi.c>
                <LocationMatch "/(ping|status)">
                        Order deny,allow
                        Deny from all
                        Allow from 127.0.0.1
                        Allow from 203.86.201.118
                        ProxyPassMatch fcgi://127.0.0.1:9999/$1
                </LocationMatch>
		ProxyPassMatch ^/(.*\.php(/.*)?)$ fcgi://127.0.0.1:9111/data/www/openleaf-co-nz/htdocs/tagged/$1
        </IfModule>

        <Directory /data/www/openleaf-co-nz/htdocs/tagged>
                Options -Indexes FollowSymLinks
		Order allow,deny
                Allow from all
                Require all granted
        </Directory>

</VirtualHost>

#redirects
<VirtualHost *:80>
        ServerName www.openleaf.co.nz
        ServerAlias www.openleaf.net.nz openleaf.net.nz
	#Redirect permanent / http://openleaf.co.nz/
        Redirect permanent / http://ddd.openleaf.co.nz/
</VirtualHost>
